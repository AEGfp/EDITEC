<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8" />
    <title>Reporte Detallado de Asistencia del Infante</title>
    <style>
        body {
            font-family: DejaVu Sans, sans-serif;
            font-size: 11px;
            margin: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 15px;
        }

        .header .title {
            font-size: 16px;
            font-weight: bold;
        }

        .section {
            margin-bottom: 20px;
        }

        .section-title {
            font-weight: bold;
            font-size: 13px;
            margin-bottom: 6px;
            border-bottom: 1px solid #000;
            padding-bottom: 2px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 11px;
        }

        th,
        td {
            border: 1px solid #ccc;
            padding: 6px;
            text-align: center;
        }

        th {
            background-color: #f2f2f2;
            font-weight: bold;
        }

        .presente {
            color: green;
            font-weight: bold;
        }

        .ausente {
            color: red;
            font-weight: bold;
        }

        .info-row {
            margin: 3px 0;
        }

        .info-label {
            font-weight: bold;
            display: inline-block;
            width: 130px;
        }
    </style>
</head>

<body>
    <div class="header">
        <div class="title">REPORTE DETALLADO DE ASISTENCIA</div>
        
    </div>

    <!-- Datos del Infante -->
    <div class="section">
        <div class="info-row"><span class="info-label">Fecha del reporte: {{ fecha_hoy }}</div>
        <div class="info-row"><span class="info-label">Nombre completo:</span> {{ infante.nombre_completo|default:"-" }}</div>
        <div class="info-row"><span class="info-label">CI:</span> {{ infante.ci|default:"-" }}</div>
        <div class="info-row"><span class="info-label">Fecha nacimiento:</span> {{ infante.fecha_nacimiento|default:"-"}}</div>
        <div class="info-row"><span class="info-label">Edad:</span> {{ infante.edad|default:"-" }} a√±os</div>
    </div>

    <!-- Resumen de Estados -->
    <div class="section">
        <div class="section-title">RESUMEN DE ESTADOS</div>
        <table>
            <thead>
                <tr>
                    <th>Estado</th>
                    <th>Cantidad</th>
                </tr>
            </thead>
            <tbody>
                {% for item in resumen_estados %}
                <tr>
                    <td>{{ item.estado|capfirst }}</td>
                    <td>{{ item.cantidad }}</td>
                </tr>
                {% endfor %}
                <tr>
                    <td><strong>Total</strong></td>
                    <td><strong>{{ total }}</strong></td>
                </tr>
            </tbody>
        </table>
    </div>

    <!-- Detalles -->
    <div class="section">
        <div class="section-title">DETALLES DE ASISTENCIA</div>
        <table>
            <thead>
                <tr>
                    <th>Fecha</th>
                    <th>Hora Entrada</th>
                    <th>Hora Salida</th>
                    <th>Estado</th>
                    <th>Usuario Auditor</th>
                </tr>
            </thead>
            <tbody>
                {% for asistencia in detalles %}
                <tr>
                    <td>{{ asistencia.fecha_formateada }}</td>
                    <td>{{ asistencia.hora_entrada_formateada|default:"-" }}</td>
                    <td>{{ asistencia.hora_salida_formateada|default:"-" }}</td>
                    <td class="{% if asistencia.estado == 'presente' %}presente{% else %}ausente{% endif %}">
                        {{ asistencia.estado|capfirst }}
                    </td>
                    <td>{{ asistencia.nombre_usuario }} {{ asistencia.apellido_usuario }}</td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="5">No hay asistencias registradas</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</body>

</html>